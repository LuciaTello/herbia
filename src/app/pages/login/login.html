<div class="login-container">

  <div class="login-header">
    <h1><img src="favicon.png" alt="" class="logo-icon" />herbia</h1>
    <div class="cycle">
      <p class="cycle-es">{{ BI.subtitleEs }}</p>
      <p class="cycle-fr">{{ BI.subtitleFr }}</p>
    </div>
  </div>

  @if (error()) {
    <p class="error-message">{{ error() }}</p>
  }

  <!-- Step 1: Email (bilingual) -->
  @if (step() === 'email') {
    <div class="card">
      <div class="cycle">
        <p class="hint cycle-es">{{ BI.explanationEs }}</p>
        <p class="hint cycle-fr">{{ BI.explanationFr }}</p>
      </div>
      <form (ngSubmit)="onCheckEmail()">
        <input
          id="email"
          type="email"
          placeholder="Email"
          [ngModel]="email()"
          (ngModelChange)="email.set($event)"
          name="email"
          required
          autofocus
        />
        <button type="submit" class="primary-button" [disabled]="loading()">
          @if (loading()) { {{ BI.submitting }} } @else { {{ BI.next }} }
        </button>
      </form>
    </div>
  }

  <!-- Step 2a: Login -->
  @if (step() === 'login') {
    <div class="card">
      <button type="button" class="back-button" (click)="goBack()">&#8592;</button>
      <p class="step-email">{{ email() }}</p>
      <h2>{{ i18n.t().login.loginTitle }}</h2>
      <form (ngSubmit)="onLogin()">
        <input
          id="password"
          type="password"
          [placeholder]="i18n.t().login.passwordPlaceholder"
          [ngModel]="password()"
          (ngModelChange)="password.set($event)"
          name="password"
          required
          autofocus
        />
        <button type="submit" class="primary-button" [disabled]="loading()">
          @if (loading()) { {{ i18n.t().login.submitting }} } @else { {{ i18n.t().login.loginButton }} }
        </button>
      </form>
    </div>
  }

  <!-- Step 2b: Register -->
  @if (step() === 'register') {
    <div class="card">
      <button type="button" class="back-button" (click)="goBack()">&#8592;</button>
      <p class="step-email">{{ email() }}</p>
      <h2>{{ i18n.t().login.registerTitle }}</h2>
      <form (ngSubmit)="onRegister()">
        <input
          id="reg-password"
          type="password"
          [placeholder]="BI.passwordPlaceholder"
          [ngModel]="password()"
          (ngModelChange)="password.set($event)"
          name="password"
          required
          autofocus
        />

        <div class="lang-picker">
          <p class="lang-label">{{ BI.chooseLang }}</p>
          <div class="lang-options">
            <button
              type="button"
              class="lang-option"
              [class.selected]="selectedLang() === 'es'"
              (click)="onLangPick('es')"
            >ES</button>
            <button
              type="button"
              class="lang-option"
              [class.selected]="selectedLang() === 'fr'"
              (click)="onLangPick('fr')"
            >FR</button>
          </div>
        </div>

        <button type="submit" class="primary-button" [disabled]="loading()">
          @if (loading()) { {{ i18n.t().login.submitting }} } @else { {{ i18n.t().login.registerButton }} }
        </button>
      </form>
    </div>
  }

</div>
